멀웨어분석 과제 2

Abexcm2-voiees.exe에서 자기 이름에 맞는 serial number 찾기

32211562 민예원

![텍스트, 스크린샷, 직사각형, 폰트이(가) 표시된 사진 자동 생성된
설명](./malwawre/media/image1.png){width="5.604948600174978in"
height="2.4170034995625547in"}

우선 틀렸을 때 메시지박스가 나오는 것에서 referenced string을
검색해본다.

![텍스트, 스크린샷, 폰트, 메뉴이(가) 표시된 사진 자동 생성된
설명](./malwawre/media/image2.png){width="6.268055555555556in"
height="4.435416666666667in"}

검색해보면 두 군데에서 메시지박스에 관한 내용이 보인다.

![텍스트, 영수증, 스크린샷이(가) 표시된 사진 자동 생성된
설명](./malwawre/media/image3.png){width="6.268055555555556in"
height="2.495833333333333in"}

윗부분

![텍스트, 스크린샷, 폰트이(가) 표시된 사진 자동 생성된
설명](./malwawre/media/image4.png){width="6.268055555555556in"
height="2.152083333333333in"}

아랫부분

이 중 아래에 있는 부분에서만 분기문이 사용되는 것으로 보아 아래 부분이
시리얼이 맞는 지 확인하는 부분임을 알 수 있다.

잘 살펴보면 PUSH EDX, PUSH EAX로 함수 호출 전에 로컬변수를 세팅하는 것이
보인다.

이에 따라 함수의 return 값은 EAX에 저장되고 EDX에 있는 값과 비교할
것으로 추측된다.

![텍스트, 영수증, 스크린샷, 폰트이(가) 표시된 사진 자동 생성된
설명](./malwawre/media/image5.png){width="6.268055555555556in"
height="1.6631944444444444in"}

함수의 실행 위치에 BP를 걸어놓고 EAX, EDX의 값을 확인해보면 항상
0019F234, 0019F224가 할당됨을 알 수 있다.

해당 위치의 hex를 살펴본다.

![](./malwawre/media/image6.png){width="4.948606736657918in"
height="0.2604527559055118in"}

Serial에 1234를 넣었을 때

![](./malwawre/media/image7.png){width="4.896516841644795in"
height="0.3021259842519685in"}

Serial에 4321을 넣었을 때

두 경우를 보면 다른 값은 다 똑같은데 0019F22C\~0019F22F와
0019F23C\~0019F23F 의 값만 바뀌는 것을 볼 수 있다.

이에 따라 해당 주소로 가서 값을 확인해본다.

![](./malwawre/media/image8.png){width="4.1672484689413825in"
height="0.15627187226596675in"}

![](./malwawre/media/image9.png){width="4.677736220472441in"
height="0.2604527559055118in"}

무슨 값을 입력하던 0019F22C\~0019F22F에 있는 주소의 hex값이 변하지 않는
점을 확인할 수 있다.

이에 따라 이를 serial number로 추측하고 이를 넣어본다.

![텍스트, 스크린샷, 폰트, 번호이(가) 표시된 사진 자동 생성된
설명](./malwawre/media/image10.png){width="4.386029090113736in"
height="1.510627734033246in"}

정답이 맞는 것을 확인할 수 있다.
